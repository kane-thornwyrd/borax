!function(a,b){if("function"==typeof define&&define.amd)define(["underscore","jquery","backbone","bluebird"],function(a,c,d,e){return b(a,c,d)});else if("undefined"!=typeof exports){var c=require("underscore"),d=require("jquery"),e=require("backbone"),f=require("bluebird");exports=module.exports=b(c,d,e,f)}else b(c,d,e,f)}(this,function(a,b,c,d){"use strict";var e,f=function(){var a,b,c=new Promise(function(){a=arguments[0],b=arguments[1]});return{resolve:a,reject:b,promise:c}},g={},h=function(){};return a.extend(h.prototype,c.Events,{on:function(a,b,d){g[a]||(g[a]=f()),c.Events.on.apply(this,arguments),g[a]===!0&&c.Events.trigger.apply(this,[a])},trigger:function(a){g[a]||(g[a]=!0),c.Events.trigger.apply(this,arguments)},once:function(a,b,d){g[a]||(g[a]=f()),c.Events.once.apply(this,arguments),g[a]===!0&&c.Events.trigger.apply(this,[a])}}),module.exports=c.Dispatcher=e?e:e=new h,c.Dispatcher});